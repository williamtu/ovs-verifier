#                             -*- compilation -*-
19. system-bpf-traffic.at:730: testing ovn -- 1 LR connects 2 LSes ...
creating ovn-sb database
creating ovn-nb database
starting ovn-northd
starting backup ovn-northd
/root/ovs-ebpf/tests/system-bpf-testsuite.dir/at-groups/19/test-source: line 14: /root/ovs-ebpf/tests/system-bpf-testsuite.dir/19: Is a directory
./system-bpf-traffic.at:734: mount -t bpf none /sys/fs/bpf
./system-bpf-traffic.at:734: mkdir -p /sys/fs/bpf/ovs
./system-bpf-traffic.at:734: ovsdb-tool create conf.db $abs_top_srcdir/vswitchd/vswitch.ovsschema
./system-bpf-traffic.at:734: ovsdb-server --detach --no-chdir --pidfile --log-file --remote=punix:$OVS_RUNDIR/db.sock
stderr:
2018-06-21T17:06:24Z|00001|vlog|INFO|opened log file /root/ovs-ebpf/tests/system-bpf-testsuite.dir/19/ovsdb-server.log
./system-bpf-traffic.at:734: sed < stderr '
/vlog|INFO|opened log file/d
/ovsdb_server|INFO|ovsdb-server (Open vSwitch)/d'
./system-bpf-traffic.at:734: ovs-vsctl --no-wait init 
./system-bpf-traffic.at:734: ovs-vswitchd --disable-system --detach --no-chdir --pidfile --log-file -vvconn -vofproto_dpif -vunixctl
stderr:
2018-06-21T17:06:24Z|00001|vlog|INFO|opened log file /root/ovs-ebpf/tests/system-bpf-testsuite.dir/19/ovs-vswitchd.log
2018-06-21T17:06:24Z|00002|ovs_numa|INFO|Discovered 4 CPU cores on NUMA node 0
2018-06-21T17:06:24Z|00003|ovs_numa|INFO|Discovered 1 NUMA nodes and 4 CPU cores
2018-06-21T17:06:24Z|00004|reconnect|INFO|unix:/root/ovs-ebpf/tests/system-bpf-testsuite.dir/19/db.sock: connecting...
2018-06-21T17:06:24Z|00005|reconnect|INFO|unix:/root/ovs-ebpf/tests/system-bpf-testsuite.dir/19/db.sock: connected
2018-06-21T17:06:24Z|00006|bpf|INFO|libbpf: load program tail-32
2018-06-21T17:06:24Z|00007|bpf|INFO|libbpf: load program tail-33
2018-06-21T17:06:24Z|00008|bpf|INFO|libbpf: load program tail-0
2018-06-21T17:06:24Z|00009|bpf|INFO|libbpf: load program tail-1
2018-06-21T17:06:24Z|00010|bpf|INFO|libbpf: load program tail-2
2018-06-21T17:06:24Z|00011|bpf|INFO|libbpf: load program tail-3
2018-06-21T17:06:24Z|00012|bpf|INFO|libbpf: load program tail-4
2018-06-21T17:06:24Z|00013|bpf|INFO|libbpf: load program tail-5
2018-06-21T17:06:24Z|00014|bpf|INFO|libbpf: load program tail-6
2018-06-21T17:06:24Z|00015|bpf|INFO|libbpf: load program tail-7
2018-06-21T17:06:24Z|00016|bpf|INFO|libbpf: load program tail-8
2018-06-21T17:06:24Z|00017|bpf|INFO|libbpf: load program tail-9
2018-06-21T17:06:24Z|00018|bpf|INFO|libbpf: load program tail-10
2018-06-21T17:06:24Z|00019|bpf|INFO|libbpf: load program tail-11
2018-06-21T17:06:24Z|00020|bpf|WARN|libbpf: load bpf program failed: Invalid argument
2018-06-21T17:06:24Z|00021|bpf|WARN|libbpf: -- BEGIN DUMP LOG ---
2018-06-21T17:06:24Z|00022|bpf|WARN|libbpf: 
0: (bf) r9 = r1
1: (61) r7 = *(u32 *)(r9 +48)
2: (b7) r1 = 0
3: (63) *(u32 *)(r10 -4) = r1
4: (b7) r2 = 32
5: (2d) if r2 > r7 goto pc+14
 R1=inv0 R2=inv32 R7=inv(id=0,umin_value=32,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-8=0
6: (73) *(u8 *)(r10 -184) = r1
7: (18) r1 = 0xa746968206e6f69
9: (7b) *(u64 *)(r10 -192) = r1
10: (18) r1 = 0x7463612066706265
12: (7b) *(u64 *)(r10 -200) = r1
13: (18) r1 = 0x2078616d20525245
15: (7b) *(u64 *)(r10 -208) = r1
16: (bf) r1 = r10
17: (07) r1 += -208
18: (b7) r2 = 25
19: (05) goto pc+279
299: (85) call bpf_trace_printk#6
300: (b7) r8 = 2
301: (bf) r0 = r8
302: (95) exit

from 5 to 20: R1=inv0 R2=inv32 R7=inv(id=0,umax_value=31,var_off=(0x0; 0x1f)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-8=0
20: (61) r1 = *(u32 *)(r9 +56)
21: (15) if r1 == 0x0 goto pc+7
 R1=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R2=inv32 R7=inv(id=0,umax_value=31,var_off=(0x0; 0x1f)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-8=0
22: (bf) r2 = r10
23: (07) r2 += -4
24: (18) r1 = 0xffff9beb26b68000
26: (85) call bpf_map_lookup_elem#1
27: (55) if r0 != 0x0 goto pc+173
 R0=inv0 R7=inv(id=0,umax_value=31,var_off=(0x0; 0x1f)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1
28: (05) goto pc+240
269: (b7) r1 = 0
270: (73) *(u8 *)(r10 -186) = r1
271: (b7) r1 = 2660
272: (6b) *(u16 *)(r10 -188) = r1
273: (b7) r1 = 1853189990
274: (63) *(u32 *)(r10 -192) = r1
275: (18) r1 = 0x206e6f6974636120
277: (7b) *(u64 *)(r10 -200) = r1
278: (18) r1 = 0x6863746162206f6e
280: (7b) *(u64 *)(r10 -208) = r1
281: (bf) r1 = r10
282: (07) r1 += -208
283: (b7) r2 = 23
284: (05) goto pc+14
299: (85) call bpf_trace_printk#6
300: safe

from 27 to 201: R0=map_value(id=0,off=0,ks=4,vs=4352,imm=0) R7=inv(id=0,umax_value=31,var_off=(0x0; 0x1f)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1
201: (7b) *(u64 *)(r10 -256) = r0
202: (27) r7 *= 136
203: (7b) *(u64 *)(r10 -248) = r7
204: (bf) r6 = r0
205: (0f) r6 += r7
206: (b7) r8 = 2
207: (15) if r6 == 0x0 goto pc+93
 R0=map_value(id=0,off=0,ks=4,vs=4352,imm=0) R6=map_value(id=0,off=0,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R7=inv(id=0,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value
208: (b7) r1 = 681061
209: (63) *(u32 *)(r10 -200) = r1
210: (18) r1 = 0x6b73616d20746573
212: (7b) *(u64 *)(r10 -208) = r1
213: (bf) r1 = r10
214: (07) r1 += -208
215: (b7) r2 = 12
216: (85) call bpf_trace_printk#6
217: (bf) r7 = r6
218: (07) r7 += 8
219: (61) r1 = *(u32 *)(r6 +8)
 R0=inv(id=0) R6=map_value(id=0,off=0,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R7_w=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value
220: (15) if r1 == 0x7 goto pc+82
 R0=inv(id=0) R1=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=map_value(id=0,off=0,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value
221: (55) if r1 != 0x4 goto pc+228
 R0=inv(id=0) R1=inv4 R6=map_value(id=0,off=0,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value
222: (61) r1 = *(u32 *)(r9 +80)
223: (7b) *(u64 *)(r10 -264) = r1
224: (61) r6 = *(u32 *)(r9 +76)
225: (b7) r1 = 0
226: (73) *(u8 *)(r10 -198) = r1
227: (b7) r1 = 2674
228: (6b) *(u16 *)(r10 -200) = r1
229: (18) r1 = 0x6568746520746573
231: (7b) *(u64 *)(r10 -208) = r1
232: (bf) r1 = r10
233: (07) r1 += -208
234: (b7) r2 = 11
235: (85) call bpf_trace_printk#6
236: (bf) r1 = r6
237: (07) r1 += 14
238: (79) r2 = *(u64 *)(r10 -264)
239: (2d) if r1 > r2 goto pc+61
 R0=inv(id=0) R1=pkt(id=0,off=14,r=14,imm=0) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
240: (71) r1 = *(u8 *)(r7 +10)
 R0=inv(id=0) R1_w=pkt(id=0,off=14,r=14,imm=0) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
241: (73) *(u8 *)(r6 +0) = r1
242: (71) r1 = *(u8 *)(r7 +11)
 R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
243: (73) *(u8 *)(r6 +1) = r1
244: (71) r1 = *(u8 *)(r7 +12)
 R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
245: (73) *(u8 *)(r6 +2) = r1
246: (71) r1 = *(u8 *)(r7 +13)
 R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
247: (73) *(u8 *)(r6 +3) = r1
248: (79) r4 = *(u64 *)(r10 -256)
249: (bf) r1 = r4
250: (79) r2 = *(u64 *)(r10 -248)
251: (0f) r1 += r2
math between map_value pointer and register with unbounded min value is not allowed
2018-06-21T17:06:24Z|00023|bpf|WARN|libbpf: -- END LOG --
2018-06-21T17:06:24Z|00024|bpf|WARN|libbpf: failed to load program 'tail-11'
2018-06-21T17:06:24Z|00025|bpf|WARN|libbpf: failed to load object '/usr/local/share/openvswitch/bpf/datapath.o'
2018-06-21T17:06:24Z|00026|bpf|WARN|Failed to load BPF datapath: Kernel verifier blocks program loading
2018-06-21T17:06:24Z|00027|bpf|WARN|Failed to load /sys/fs/bpf/ovs//tail-63/0: No such file or directory
2018-06-21T17:06:24Z|00028|dpif|WARN|failed to initialize bpf datapath class: No such file or directory
./system-bpf-traffic.at:734: sed < stderr '
/bpf|INFO|/d
/odp_util.*ERR/d
/ovs_numa|INFO|Discovered /d
/vlog|INFO|opened log file/d
/vswitchd|INFO|ovs-vswitchd (Open vSwitch)/d
/reconnect|INFO|/d
/ofproto|INFO|using datapath ID/d
/netdev_linux|INFO|.*device has unknown hardware address family/d
/ofproto|INFO|datapath ID changed to fedcba9876543210/d
/dpdk|INFO|DPDK Disabled - Use other_config:dpdk-init to enable/d
/netdev: Flow API/d
/Re-using preloaded BPF datapath/d
/tc: Using policy/d'
--- /dev/null	2018-06-21 07:36:47.447832466 -0700
+++ /root/ovs-ebpf/tests/system-bpf-testsuite.dir/at-groups/19/stdout	2018-06-21 10:06:24.709197191 -0700
@@ -0,0 +1,120 @@
+2018-06-21T17:06:24Z|00020|bpf|WARN|libbpf: load bpf program failed: Invalid argument
+2018-06-21T17:06:24Z|00021|bpf|WARN|libbpf: -- BEGIN DUMP LOG ---
+2018-06-21T17:06:24Z|00022|bpf|WARN|libbpf: 
+0: (bf) r9 = r1
+1: (61) r7 = *(u32 *)(r9 +48)
+2: (b7) r1 = 0
+3: (63) *(u32 *)(r10 -4) = r1
+4: (b7) r2 = 32
+5: (2d) if r2 > r7 goto pc+14
+ R1=inv0 R2=inv32 R7=inv(id=0,umin_value=32,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-8=0
+6: (73) *(u8 *)(r10 -184) = r1
+7: (18) r1 = 0xa746968206e6f69
+9: (7b) *(u64 *)(r10 -192) = r1
+10: (18) r1 = 0x7463612066706265
+12: (7b) *(u64 *)(r10 -200) = r1
+13: (18) r1 = 0x2078616d20525245
+15: (7b) *(u64 *)(r10 -208) = r1
+16: (bf) r1 = r10
+17: (07) r1 += -208
+18: (b7) r2 = 25
+19: (05) goto pc+279
+299: (85) call bpf_trace_printk#6
+300: (b7) r8 = 2
+301: (bf) r0 = r8
+302: (95) exit
+
+from 5 to 20: R1=inv0 R2=inv32 R7=inv(id=0,umax_value=31,var_off=(0x0; 0x1f)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-8=0
+20: (61) r1 = *(u32 *)(r9 +56)
+21: (15) if r1 == 0x0 goto pc+7
+ R1=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R2=inv32 R7=inv(id=0,umax_value=31,var_off=(0x0; 0x1f)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-8=0
+22: (bf) r2 = r10
+23: (07) r2 += -4
+24: (18) r1 = 0xffff9beb26b68000
+26: (85) call bpf_map_lookup_elem#1
+27: (55) if r0 != 0x0 goto pc+173
+ R0=inv0 R7=inv(id=0,umax_value=31,var_off=(0x0; 0x1f)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1
+28: (05) goto pc+240
+269: (b7) r1 = 0
+270: (73) *(u8 *)(r10 -186) = r1
+271: (b7) r1 = 2660
+272: (6b) *(u16 *)(r10 -188) = r1
+273: (b7) r1 = 1853189990
+274: (63) *(u32 *)(r10 -192) = r1
+275: (18) r1 = 0x206e6f6974636120
+277: (7b) *(u64 *)(r10 -200) = r1
+278: (18) r1 = 0x6863746162206f6e
+280: (7b) *(u64 *)(r10 -208) = r1
+281: (bf) r1 = r10
+282: (07) r1 += -208
+283: (b7) r2 = 23
+284: (05) goto pc+14
+299: (85) call bpf_trace_printk#6
+300: safe
+
+from 27 to 201: R0=map_value(id=0,off=0,ks=4,vs=4352,imm=0) R7=inv(id=0,umax_value=31,var_off=(0x0; 0x1f)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1
+201: (7b) *(u64 *)(r10 -256) = r0
+202: (27) r7 *= 136
+203: (7b) *(u64 *)(r10 -248) = r7
+204: (bf) r6 = r0
+205: (0f) r6 += r7
+206: (b7) r8 = 2
+207: (15) if r6 == 0x0 goto pc+93
+ R0=map_value(id=0,off=0,ks=4,vs=4352,imm=0) R6=map_value(id=0,off=0,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R7=inv(id=0,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value
+208: (b7) r1 = 681061
+209: (63) *(u32 *)(r10 -200) = r1
+210: (18) r1 = 0x6b73616d20746573
+212: (7b) *(u64 *)(r10 -208) = r1
+213: (bf) r1 = r10
+214: (07) r1 += -208
+215: (b7) r2 = 12
+216: (85) call bpf_trace_printk#6
+217: (bf) r7 = r6
+218: (07) r7 += 8
+219: (61) r1 = *(u32 *)(r6 +8)
+ R0=inv(id=0) R6=map_value(id=0,off=0,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R7_w=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value
+220: (15) if r1 == 0x7 goto pc+82
+ R0=inv(id=0) R1=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=map_value(id=0,off=0,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value
+221: (55) if r1 != 0x4 goto pc+228
+ R0=inv(id=0) R1=inv4 R6=map_value(id=0,off=0,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value
+222: (61) r1 = *(u32 *)(r9 +80)
+223: (7b) *(u64 *)(r10 -264) = r1
+224: (61) r6 = *(u32 *)(r9 +76)
+225: (b7) r1 = 0
+226: (73) *(u8 *)(r10 -198) = r1
+227: (b7) r1 = 2674
+228: (6b) *(u16 *)(r10 -200) = r1
+229: (18) r1 = 0x6568746520746573
+231: (7b) *(u64 *)(r10 -208) = r1
+232: (bf) r1 = r10
+233: (07) r1 += -208
+234: (b7) r2 = 11
+235: (85) call bpf_trace_printk#6
+236: (bf) r1 = r6
+237: (07) r1 += 14
+238: (79) r2 = *(u64 *)(r10 -264)
+239: (2d) if r1 > r2 goto pc+61
+ R0=inv(id=0) R1=pkt(id=0,off=14,r=14,imm=0) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
+240: (71) r1 = *(u8 *)(r7 +10)
+ R0=inv(id=0) R1_w=pkt(id=0,off=14,r=14,imm=0) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
+241: (73) *(u8 *)(r6 +0) = r1
+242: (71) r1 = *(u8 *)(r7 +11)
+ R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
+243: (73) *(u8 *)(r6 +1) = r1
+244: (71) r1 = *(u8 *)(r7 +12)
+ R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
+245: (73) *(u8 *)(r6 +2) = r1
+246: (71) r1 = *(u8 *)(r7 +13)
+ R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
+247: (73) *(u8 *)(r6 +3) = r1
+248: (79) r4 = *(u64 *)(r10 -256)
+249: (bf) r1 = r4
+250: (79) r2 = *(u64 *)(r10 -248)
+251: (0f) r1 += r2
+math between map_value pointer and register with unbounded min value is not allowed
+2018-06-21T17:06:24Z|00023|bpf|WARN|libbpf: -- END LOG --
+2018-06-21T17:06:24Z|00024|bpf|WARN|libbpf: failed to load program 'tail-11'
+2018-06-21T17:06:24Z|00025|bpf|WARN|libbpf: failed to load object '/usr/local/share/openvswitch/bpf/datapath.o'
+2018-06-21T17:06:24Z|00026|bpf|WARN|Failed to load BPF datapath: Kernel verifier blocks program loading
+2018-06-21T17:06:24Z|00027|bpf|WARN|Failed to load /sys/fs/bpf/ovs//tail-63/0: No such file or directory
+2018-06-21T17:06:24Z|00028|dpif|WARN|failed to initialize bpf datapath class: No such file or directory
ovsdb-server.log:
> 2018-06-21T17:06:24.675Z|00001|vlog|INFO|opened log file /root/ovs-ebpf/tests/system-bpf-testsuite.dir/19/ovsdb-server.log
> 2018-06-21T17:06:24.678Z|00002|ovsdb_server|INFO|ovsdb-server (Open vSwitch) 2.9.1
ovs-vswitchd.log:
> 2018-06-21T17:06:24.692Z|00001|vlog|INFO|opened log file /root/ovs-ebpf/tests/system-bpf-testsuite.dir/19/ovs-vswitchd.log
> 2018-06-21T17:06:24.693Z|00002|ovs_numa|INFO|Discovered 4 CPU cores on NUMA node 0
> 2018-06-21T17:06:24.693Z|00003|ovs_numa|INFO|Discovered 1 NUMA nodes and 4 CPU cores
> 2018-06-21T17:06:24.693Z|00004|reconnect|INFO|unix:/root/ovs-ebpf/tests/system-bpf-testsuite.dir/19/db.sock: connecting...
> 2018-06-21T17:06:24.693Z|00005|reconnect|INFO|unix:/root/ovs-ebpf/tests/system-bpf-testsuite.dir/19/db.sock: connected
> 2018-06-21T17:06:24.696Z|00006|bpf|INFO|libbpf: load program tail-32
> 2018-06-21T17:06:24.698Z|00007|bpf|INFO|libbpf: load program tail-33
> 2018-06-21T17:06:24.698Z|00008|bpf|INFO|libbpf: load program tail-0
> 2018-06-21T17:06:24.698Z|00009|bpf|INFO|libbpf: load program tail-1
> 2018-06-21T17:06:24.699Z|00010|bpf|INFO|libbpf: load program tail-2
> 2018-06-21T17:06:24.699Z|00011|bpf|INFO|libbpf: load program tail-3
> 2018-06-21T17:06:24.699Z|00012|bpf|INFO|libbpf: load program tail-4
> 2018-06-21T17:06:24.700Z|00013|bpf|INFO|libbpf: load program tail-5
> 2018-06-21T17:06:24.700Z|00014|bpf|INFO|libbpf: load program tail-6
> 2018-06-21T17:06:24.700Z|00015|bpf|INFO|libbpf: load program tail-7
> 2018-06-21T17:06:24.700Z|00016|bpf|INFO|libbpf: load program tail-8
> 2018-06-21T17:06:24.701Z|00017|bpf|INFO|libbpf: load program tail-9
> 2018-06-21T17:06:24.701Z|00018|bpf|INFO|libbpf: load program tail-10
> 2018-06-21T17:06:24.701Z|00019|bpf|INFO|libbpf: load program tail-11
> 2018-06-21T17:06:24.701Z|00020|bpf|WARN|libbpf: load bpf program failed: Invalid argument
> 2018-06-21T17:06:24.701Z|00021|bpf|WARN|libbpf: -- BEGIN DUMP LOG ---
> 2018-06-21T17:06:24.701Z|00022|bpf|WARN|libbpf: 
> 0: (bf) r9 = r1
> 1: (61) r7 = *(u32 *)(r9 +48)
> 2: (b7) r1 = 0
> 3: (63) *(u32 *)(r10 -4) = r1
> 4: (b7) r2 = 32
> 5: (2d) if r2 > r7 goto pc+14
>  R1=inv0 R2=inv32 R7=inv(id=0,umin_value=32,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-8=0
> 6: (73) *(u8 *)(r10 -184) = r1
> 7: (18) r1 = 0xa746968206e6f69
> 9: (7b) *(u64 *)(r10 -192) = r1
> 10: (18) r1 = 0x7463612066706265
> 12: (7b) *(u64 *)(r10 -200) = r1
> 13: (18) r1 = 0x2078616d20525245
> 15: (7b) *(u64 *)(r10 -208) = r1
> 16: (bf) r1 = r10
> 17: (07) r1 += -208
> 18: (b7) r2 = 25
> 19: (05) goto pc+279
> 299: (85) call bpf_trace_printk#6
> 300: (b7) r8 = 2
> 301: (bf) r0 = r8
> 302: (95) exit
> 
> from 5 to 20: R1=inv0 R2=inv32 R7=inv(id=0,umax_value=31,var_off=(0x0; 0x1f)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-8=0
> 20: (61) r1 = *(u32 *)(r9 +56)
> 21: (15) if r1 == 0x0 goto pc+7
>  R1=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R2=inv32 R7=inv(id=0,umax_value=31,var_off=(0x0; 0x1f)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-8=0
> 22: (bf) r2 = r10
> 23: (07) r2 += -4
> 24: (18) r1 = 0xffff9beb26b68000
> 26: (85) call bpf_map_lookup_elem#1
> 27: (55) if r0 != 0x0 goto pc+173
>  R0=inv0 R7=inv(id=0,umax_value=31,var_off=(0x0; 0x1f)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1
> 28: (05) goto pc+240
> 269: (b7) r1 = 0
> 270: (73) *(u8 *)(r10 -186) = r1
> 271: (b7) r1 = 2660
> 272: (6b) *(u16 *)(r10 -188) = r1
> 273: (b7) r1 = 1853189990
> 274: (63) *(u32 *)(r10 -192) = r1
> 275: (18) r1 = 0x206e6f6974636120
> 277: (7b) *(u64 *)(r10 -200) = r1
> 278: (18) r1 = 0x6863746162206f6e
> 280: (7b) *(u64 *)(r10 -208) = r1
> 281: (bf) r1 = r10
> 282: (07) r1 += -208
> 283: (b7) r2 = 23
> 284: (05) goto pc+14
> 299: (85) call bpf_trace_printk#6
> 300: safe
> 
> from 27 to 201: R0=map_value(id=0,off=0,ks=4,vs=4352,imm=0) R7=inv(id=0,umax_value=31,var_off=(0x0; 0x1f)) R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1
> 201: (7b) *(u64 *)(r10 -256) = r0
> 202: (27) r7 *= 136
> 203: (7b) *(u64 *)(r10 -248) = r7
> 204: (bf) r6 = r0
> 205: (0f) r6 += r7
> 206: (b7) r8 = 2
> 207: (15) if r6 == 0x0 goto pc+93
>  R0=map_value(id=0,off=0,ks=4,vs=4352,imm=0) R6=map_value(id=0,off=0,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R7=inv(id=0,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value
> 208: (b7) r1 = 681061
> 209: (63) *(u32 *)(r10 -200) = r1
> 210: (18) r1 = 0x6b73616d20746573
> 212: (7b) *(u64 *)(r10 -208) = r1
> 213: (bf) r1 = r10
> 214: (07) r1 += -208
> 215: (b7) r2 = 12
> 216: (85) call bpf_trace_printk#6
> 217: (bf) r7 = r6
> 218: (07) r7 += 8
> 219: (61) r1 = *(u32 *)(r6 +8)
>  R0=inv(id=0) R6=map_value(id=0,off=0,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R7_w=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value
> 220: (15) if r1 == 0x7 goto pc+82
>  R0=inv(id=0) R1=inv(id=0,umax_value=4294967295,var_off=(0x0; 0xffffffff)) R6=map_value(id=0,off=0,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value
> 221: (55) if r1 != 0x4 goto pc+228
>  R0=inv(id=0) R1=inv4 R6=map_value(id=0,off=0,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value
> 222: (61) r1 = *(u32 *)(r9 +80)
> 223: (7b) *(u64 *)(r10 -264) = r1
> 224: (61) r6 = *(u32 *)(r9 +76)
> 225: (b7) r1 = 0
> 226: (73) *(u8 *)(r10 -198) = r1
> 227: (b7) r1 = 2674
> 228: (6b) *(u16 *)(r10 -200) = r1
> 229: (18) r1 = 0x6568746520746573
> 231: (7b) *(u64 *)(r10 -208) = r1
> 232: (bf) r1 = r10
> 233: (07) r1 += -208
> 234: (b7) r2 = 11
> 235: (85) call bpf_trace_printk#6
> 236: (bf) r1 = r6
> 237: (07) r1 += 14
> 238: (79) r2 = *(u64 *)(r10 -264)
> 239: (2d) if r1 > r2 goto pc+61
>  R0=inv(id=0) R1=pkt(id=0,off=14,r=14,imm=0) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
> 240: (71) r1 = *(u8 *)(r7 +10)
>  R0=inv(id=0) R1_w=pkt(id=0,off=14,r=14,imm=0) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
> 241: (73) *(u8 *)(r6 +0) = r1
> 242: (71) r1 = *(u8 *)(r7 +11)
>  R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
> 243: (73) *(u8 *)(r6 +1) = r1
> 244: (71) r1 = *(u8 *)(r7 +12)
>  R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
> 245: (73) *(u8 *)(r6 +2) = r1
> 246: (71) r1 = *(u8 *)(r7 +13)
>  R0=inv(id=0) R1_w=inv(id=0,umax_value=255,var_off=(0x0; 0xff)) R2=pkt_end(id=0,off=0,imm=0) R6=pkt(id=0,off=0,r=14,imm=0) R7=map_value(id=0,off=8,ks=4,vs=4352,umax_value=4216,var_off=(0x0; 0x1ff8)) R8=inv2 R9=ctx(id=0,off=0,imm=0) R10=fp0,call_-1 fp-256=map_value fp-264=pkt_end
> 247: (73) *(u8 *)(r6 +3) = r1
> 248: (79) r4 = *(u64 *)(r10 -256)
> 249: (bf) r1 = r4
> 250: (79) r2 = *(u64 *)(r10 -248)
> 251: (0f) r1 += r2
> math between map_value pointer and register with unbounded min value is not allowed
> 2018-06-21T17:06:24.701Z|00023|bpf|WARN|libbpf: -- END LOG --
> 2018-06-21T17:06:24.701Z|00024|bpf|WARN|libbpf: failed to load program 'tail-11'
> 2018-06-21T17:06:24.701Z|00025|bpf|WARN|libbpf: failed to load object '/usr/local/share/openvswitch/bpf/datapath.o'
> 2018-06-21T17:06:24.702Z|00026|bpf|WARN|Failed to load BPF datapath: Kernel verifier blocks program loading
> 2018-06-21T17:06:24.702Z|00027|bpf|WARN|Failed to load /sys/fs/bpf/ovs//tail-63/0: No such file or directory
> 2018-06-21T17:06:24.702Z|00028|dpif|WARN|failed to initialize bpf datapath class: No such file or directory
> 2018-06-21T17:06:24.703Z|00029|bridge|INFO|ovs-vswitchd (Open vSwitch) 2.9.1
19. system-bpf-traffic.at:730: 19. ovn -- 1 LR connects 2 LSes (system-bpf-traffic.at:730): FAILED (system-bpf-traffic.at:734)
